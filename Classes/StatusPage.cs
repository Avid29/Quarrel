using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Windows.Storage.Streams;
using HtmlAgilityPack;
using Newtonsoft.Json;
using Windows.Web.Http;
using Windows.Web.Http.Headers;

namespace Discord_UWP.Classes
{
   public static class StatusPage
   {
       public static string Url = "https://discord.statuspage.io/";
       public static string MetricsId = "ztt4777v23lf";
       public static string Token = null;
       public static string Cookies = "";

       public static async Task<StatusPageClasses.Index> GetStatus()
       {
           using (HttpClient client = new HttpClient())
           {
               IInputStream stream;
               try
               {
                   stream = await client.GetInputStreamAsync(new Uri(Url + "index.json"));
               }
               catch (Exception)
               {
                   return null;
               }
               using (StreamReader reader = new StreamReader(stream.AsStreamForRead()))
               {
                   using (var jsonTextReader = new JsonTextReader(reader))
                   {
                       JsonSerializer serializer = new JsonSerializer();
                       return serializer.Deserialize<StatusPageClasses.Index>(jsonTextReader);
                   }
                }
            }
       }
        public static async Task<StatusPageClasses.Index> GetStatusOutage()
        {
            string content = "{\"page\":{\"id\":\"srhpyqt94yxb\",\"name\":\"Discord\",\"url\":\"http://status.discordapp.com\"},\"status\":{\"indicator\":\"minor\",\"description\":\"Minor Service Outage\"},\"components\":[{\"status\":\"partial_outage\",\"name\":\"API\",\"created_at\":\"2015-07-30T18:55:43.739-07:00\",\"updated_at\":\"2018-12-04T10:42:59.009-08:00\",\"position\":1,\"description\":null,\"showcase\":true,\"id\":\"rhznvxg4v7yh\",\"page_id\":\"srhpyqt94yxb\",\"group_id\":null},{\"status\":\"operational\",\"name\":\"Gateway\",\"created_at\":\"2016-04-17T02:38:56.452-07:00\",\"updated_at\":\"2018-07-17T13:00:35.437-07:00\",\"position\":2,\"description\":null,\"showcase\":true,\"id\":\"9lgt8qqpcqck\",\"page_id\":\"srhpyqt94yxb\",\"group_id\":null},{\"status\":\"operational\",\"name\":\"CloudFlare\",\"created_at\":\"2015-10-05T09:20:35.448-07:00\",\"updated_at\":\"2017-08-02T10:51:25.384-07:00\",\"position\":3,\"description\":\"CloudFlare is our DDoS protection provider and proxies all of our traffic through their network.\",\"showcase\":false,\"id\":\"gvg1c6688r5y\",\"page_id\":\"srhpyqt94yxb\",\"group_id\":null},{\"status\":\"operational\",\"name\":\"Media Proxy\",\"created_at\":\"2017-09-29T06:48:27.551-07:00\",\"updated_at\":\"2018-07-17T13:00:35.493-07:00\",\"position\":4,\"description\":\"Service responsible for resizing images for thumbnail display\",\"showcase\":true,\"id\":\"r3wq1zsx72bz\",\"page_id\":\"srhpyqt94yxb\",\"group_id\":null},{\"status\":\"operational\",\"name\":\"Voice\",\"created_at\":\"2015-07-30T20:39:36.003-07:00\",\"updated_at\":\"2017-09-29T06:48:54.042-07:00\",\"position\":5,\"description\":null,\"showcase\":false,\"id\":\"jk03xttfcz9b\",\"page_id\":\"srhpyqt94yxb\",\"group_id\":null,\"components\":[\"0cwvg0jp5cbg\",\"fc8y53dfg85y\",\"q0lbnfc59j35\",\"qbt7ryjc5tcd\",\"nhlpbmmcffcl\",\"kdz8bp5dp08v\",\"gmppldfdghcd\",\"334vzyzzwlfs\",\"sg02vq1rbfrr\",\"0ysw0jy8hnsr\",\"ccgfj3l84lvt\",\"xggnf9hnngkt\",\"b5v9r9bdppvm\"]}],\"incidents\":[{\"name\":\"Increased API Latency & Failed Message Sends\",\"status\":\"investigating\",\"created_at\":\"2018-12-04T10:42:58.947-08:00\",\"updated_at\":\"2018-12-04T10:42:59.070-08:00\",\"monitoring_at\":null,\"resolved_at\":null,\"impact\":\"major\",\"shortlink\":\"http://stspg.io/ac6d3d8c6\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"fhmw9xp2f326\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"investigating\",\"body\":\"We are aware of issues regarding higher than normal latency, and failed message sends.  This issue is being actively investigated.\",\"created_at\":\"2018-12-04T10:42:59.067-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-12-04T10:42:59.067-08:00\",\"display_at\":\"2018-12-04T10:42:59.067-08:00\",\"affected_components\":[{\"code\":\"rhznvxg4v7yh\",\"name\":\"API\",\"old_status\":\"operational\",\"new_status\":\"partial_outage\"}],\"deliver_notifications\":true,\"tweet_id\":null,\"id\":\"f32246jql1vz\",\"incident_id\":\"fhmw9xp2f326\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Connection Issues\",\"status\":\"resolved\",\"created_at\":\"2018-12-03T09:09:00.018-08:00\",\"updated_at\":\"2018-12-03T09:58:22.586-08:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-12-03T09:58:22.563-08:00\",\"impact\":\"major\",\"shortlink\":\"http://stspg.io/36af500d4\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"sz116hqvqj6s\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"The degraded infrastructure has been identified and repaired, service should now be operational in EU-Central.\",\"created_at\":\"2018-12-03T09:58:22.563-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-12-03T09:58:22.563-08:00\",\"display_at\":\"2018-12-03T09:58:22.563-08:00\",\"affected_components\":[{\"code\":\"fc8y53dfg85y\",\"name\":\"Voice - EU Central\",\"old_status\":\"partial_outage\",\"new_status\":\"operational\"}],\"deliver_notifications\":true,\"tweet_id\":null,\"id\":\"mlljjcb1x1r0\",\"incident_id\":\"sz116hqvqj6s\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"Issue connecting to EU-Central voice servers is being actively investigated.\",\"created_at\":\"2018-12-03T09:09:00.126-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-12-03T09:09:00.126-08:00\",\"display_at\":\"2018-12-03T09:09:00.126-08:00\",\"affected_components\":[{\"code\":\"fc8y53dfg85y\",\"name\":\"Voice - EU Central\",\"old_status\":\"operational\",\"new_status\":\"partial_outage\"}],\"deliver_notifications\":true,\"tweet_id\":null,\"id\":\"mhw0pzq4z9xs\",\"incident_id\":\"sz116hqvqj6s\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Some Slowness + Private Calls are Sometimes Failing\",\"status\":\"resolved\",\"created_at\":\"2018-11-21T21:48:30.579-08:00\",\"updated_at\":\"2018-11-21T22:09:39.519-08:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-11-21T22:09:39.504-08:00\",\"impact\":\"none\",\"shortlink\":\"http://stspg.io/937755804\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"1621wd61247n\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"Discord is back to normal and everything should be working again.\",\"created_at\":\"2018-11-21T22:09:39.504-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-21T22:09:39.504-08:00\",\"display_at\":\"2018-11-21T22:09:39.504-08:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"12smkggd9hyd\",\"incident_id\":\"1621wd61247n\",\"custom_tweet\":null},{\"status\":\"identified\",\"body\":\"We have identified an issue causing Discord to be a little slow and private calls (in direct messages/groups) to fail. We're rolling out a fix now.\",\"created_at\":\"2018-11-21T21:48:30.610-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-21T21:48:30.610-08:00\",\"display_at\":\"2018-11-21T21:48:30.610-08:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"n1f98b5cbzt6\",\"incident_id\":\"1621wd61247n\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Issues connecting\",\"status\":\"resolved\",\"created_at\":\"2018-11-12T14:08:01.129-08:00\",\"updated_at\":\"2018-11-12T16:09:04.566-08:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-11-12T16:09:04.551-08:00\",\"impact\":\"none\",\"shortlink\":\"http://stspg.io/87cae7280\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"rs3tgn3p93tm\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"We've confirmed that all previous connection issues have been resolved. We apologize for any inconvenience.\",\"created_at\":\"2018-11-12T16:09:04.551-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-12T16:09:04.551-08:00\",\"display_at\":\"2018-11-12T16:09:04.551-08:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"rsg3g4gq0rxf\",\"incident_id\":\"rs3tgn3p93tm\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"We're aware that these connection issues may be affecting users outside of Finland and are continuing to investigate.\",\"created_at\":\"2018-11-12T14:35:09.020-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-12T14:35:09.020-08:00\",\"display_at\":\"2018-11-12T14:35:09.020-08:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"zyqmkfz47nfp\",\"incident_id\":\"rs3tgn3p93tm\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"We are continuing to investigate this issue.\",\"created_at\":\"2018-11-12T14:31:29.796-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-12T14:31:29.796-08:00\",\"display_at\":\"2018-11-12T14:31:29.796-08:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"kvw5154wv3sv\",\"incident_id\":\"rs3tgn3p93tm\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"We're seeing an elevated rate of errors and user reports describing connection errors when connecting. We're currently investigating and working with our upstream providers to diagnose and resolve this issue.\",\"created_at\":\"2018-11-12T14:08:01.158-08:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-12T14:31:00.723-08:00\",\"display_at\":\"2018-11-12T14:08:01.158-08:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"5ml2kvvlrtd9\",\"incident_id\":\"rs3tgn3p93tm\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Attachment Image Previews\",\"status\":\"resolved\",\"created_at\":\"2018-11-01T20:00:13.298-07:00\",\"updated_at\":\"2018-11-01T20:59:13.367-07:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-11-01T20:59:13.347-07:00\",\"impact\":\"none\",\"shortlink\":\"http://stspg.io/c95861082\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"56xxqwgs71fl\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"The image resizing service has been successfully resurrected. Images that failed to load in the past should load again with a restart of the client.\\n\\nThe cluster got itself into a metastable failure-state due to a service discovery mechanism getting overloaded due to a new workload we've introduced onto the cluster in the past month. A deploy to fix a bug tripped it up. We've modified configurations to make this not happen, and will be taking appropriate measures over the next week to ensure that such an issue does not recur. \\n\\nWe apologize for any inconvenience this has caused!\",\"created_at\":\"2018-11-01T20:59:13.347-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-01T20:59:13.347-07:00\",\"display_at\":\"2018-11-01T20:59:13.347-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"rpm4l91q612c\",\"incident_id\":\"56xxqwgs71fl\",\"custom_tweet\":null},{\"status\":\"identified\",\"body\":\"This issue will also affect icons throughout the application as we recover our image resizing service.\",\"created_at\":\"2018-11-01T20:07:52.149-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-01T20:07:52.149-07:00\",\"display_at\":\"2018-11-01T20:07:52.149-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"vsmkq77xrhs1\",\"incident_id\":\"56xxqwgs71fl\",\"custom_tweet\":null},{\"status\":\"identified\",\"body\":\"We are aware of issues with the attachment image previews not working - and are working on a fix currently.\",\"created_at\":\"2018-11-01T20:00:13.353-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-11-01T20:00:13.353-07:00\",\"display_at\":\"2018-11-01T20:00:13.353-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"fz1gpx1s8vhw\",\"incident_id\":\"56xxqwgs71fl\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Connection issues with starting new sessions\",\"status\":\"resolved\",\"created_at\":\"2018-10-10T17:07:28.714-07:00\",\"updated_at\":\"2018-10-10T17:29:53.838-07:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-10-10T17:29:53.820-07:00\",\"impact\":\"none\",\"shortlink\":\"http://stspg.io/1fe4e51c7\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"3jq6cmxgxgpr\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"This incident has been resolved.\",\"created_at\":\"2018-10-10T17:29:53.820-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-10T17:29:53.820-07:00\",\"display_at\":\"2018-10-10T17:29:53.820-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"tj6fgf9cy2sw\",\"incident_id\":\"3jq6cmxgxgpr\",\"custom_tweet\":null},{\"status\":\"identified\",\"body\":\"The issue has been identified and we are working on fixing it.\",\"created_at\":\"2018-10-10T17:07:28.761-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-10T17:07:28.761-07:00\",\"display_at\":\"2018-10-10T17:07:28.761-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"s4kdfw7k34zk\",\"incident_id\":\"3jq6cmxgxgpr\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Sending DMs currently impacted\",\"status\":\"resolved\",\"created_at\":\"2018-10-09T15:08:31.109-07:00\",\"updated_at\":\"2018-10-09T15:26:50.400-07:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-10-09T15:26:50.380-07:00\",\"impact\":\"none\",\"shortlink\":\"http://stspg.io/728e1758b\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"m57z7s170pww\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"This incident has been resolved.\",\"created_at\":\"2018-10-09T15:26:50.380-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-09T15:26:50.380-07:00\",\"display_at\":\"2018-10-09T15:26:50.380-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"7y2g4pq0hj5p\",\"incident_id\":\"m57z7s170pww\",\"custom_tweet\":null},{\"status\":\"identified\",\"body\":\"The issue has been identified and a fix is being implemented.\",\"created_at\":\"2018-10-09T15:08:46.910-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-09T15:08:46.910-07:00\",\"display_at\":\"2018-10-09T15:08:46.910-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"65q3pm0fhqz0\",\"incident_id\":\"m57z7s170pww\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"We're aware of an issue affecting sending DMs and viewing online friends.  We're online and working on a resolution\",\"created_at\":\"2018-10-09T15:08:31.154-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-09T15:08:31.154-07:00\",\"display_at\":\"2018-10-09T15:08:31.154-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"zz8m3vpf4bdr\",\"incident_id\":\"m57z7s170pww\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Increased API Latency & Failed Message Sends\",\"status\":\"resolved\",\"created_at\":\"2018-10-04T11:28:52.147-07:00\",\"updated_at\":\"2018-10-04T11:35:23.187-07:00\",\"monitoring_at\":\"2018-10-04T11:31:45.581-07:00\",\"resolved_at\":\"2018-10-04T11:35:23.165-07:00\",\"impact\":\"minor\",\"shortlink\":\"http://stspg.io/d1f3e8c39\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"nsc2bnb6tpj9\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"The secondary that previously failed has successfully snuggled up near a warm fire with a cozy blanket and some hot cocoa and is now adequately warm to serve traffic at nominal latency.\",\"created_at\":\"2018-10-04T11:35:23.165-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-04T11:35:23.165-07:00\",\"display_at\":\"2018-10-04T11:35:23.165-07:00\",\"affected_components\":[{\"code\":\"rhznvxg4v7yh\",\"name\":\"API\",\"old_status\":\"degraded_performance\",\"new_status\":\"operational\"}],\"deliver_notifications\":true,\"tweet_id\":null,\"id\":\"dpbf2dv56yw0\",\"incident_id\":\"nsc2bnb6tpj9\",\"custom_tweet\":null},{\"status\":\"monitoring\",\"body\":\"The secondary appears to be sufficiently warm now, and we are noticing error rates and latency drop to nominal levels.\",\"created_at\":\"2018-10-04T11:31:45.581-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-04T11:31:45.581-07:00\",\"display_at\":\"2018-10-04T11:31:45.581-07:00\",\"affected_components\":[{\"code\":\"rhznvxg4v7yh\",\"name\":\"API\",\"old_status\":\"degraded_performance\",\"new_status\":\"degraded_performance\"}],\"deliver_notifications\":true,\"tweet_id\":null,\"id\":\"xb8j5x1rd3w6\",\"incident_id\":\"nsc2bnb6tpj9\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"We are aware of issues regarding higher than normal latency, and failed message sends. The team is aware of the root cause of the issue (a host error on one of our database secondaries caused it to reboot). \\n\\nDuring this time, the secondary is \\\"cold\\\" as it loads data into memory. We are monitoring the instance as it warms up, and expect latency to fully recover in 5-15 minutes, and latency to continue to as the secondary gradually warms up.\",\"created_at\":\"2018-10-04T11:28:52.219-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-10-04T11:30:22.660-07:00\",\"display_at\":\"2018-10-04T11:28:52.219-07:00\",\"affected_components\":[{\"code\":\"rhznvxg4v7yh\",\"name\":\"API\",\"old_status\":\"operational\",\"new_status\":\"degraded_performance\"}],\"deliver_notifications\":true,\"tweet_id\":null,\"id\":\"wg1t6gjzpnr6\",\"incident_id\":\"nsc2bnb6tpj9\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Friends Lists & DMs\",\"status\":\"resolved\",\"created_at\":\"2018-09-30T10:44:46.413-07:00\",\"updated_at\":\"2018-09-30T10:57:39.102-07:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-09-30T10:57:39.087-07:00\",\"impact\":\"none\",\"shortlink\":\"http://stspg.io/c5004c1ba\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"zdk3v47wfm4c\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"We're good again. Additional configuration changes have been made to hopefully reduce the likelihood of this happening again. \\n\\nWe believe this issue to be unrelated to the earlier issues, even though the end-user effect is the same. Essentially, GCP decided to migrate 50% of the cluster at the same time, causing a large dip in throughput and causing the cluster to degrade and require manual intervention.\",\"created_at\":\"2018-09-30T10:57:39.087-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-09-30T10:57:39.087-07:00\",\"display_at\":\"2018-09-30T10:57:39.087-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"6jw4nl9zzlxc\",\"incident_id\":\"zdk3v47wfm4c\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"We're having a slight struggle again with DMs and Friends Lists. \\n\\nOur team is online and working on the issue.\",\"created_at\":\"2018-09-30T10:44:46.457-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-09-30T10:44:46.457-07:00\",\"display_at\":\"2018-09-30T10:44:46.457-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"708pjpw8g6qy\",\"incident_id\":\"zdk3v47wfm4c\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false},{\"name\":\"Friends Lists & DMs\",\"status\":\"resolved\",\"created_at\":\"2018-09-30T09:37:08.032-07:00\",\"updated_at\":\"2018-09-30T10:05:41.011-07:00\",\"monitoring_at\":null,\"resolved_at\":\"2018-09-30T10:05:40.992-07:00\",\"impact\":\"none\",\"shortlink\":\"http://stspg.io/9e91dcca9\",\"scheduled_for\":null,\"scheduled_until\":null,\"scheduled_remind_prior\":false,\"scheduled_reminded_at\":null,\"impact_override\":null,\"scheduled_auto_in_progress\":false,\"scheduled_auto_completed\":false,\"metadata\":{},\"id\":\"r4fxdx5t8lls\",\"page_id\":\"srhpyqt94yxb\",\"incident_updates\":[{\"status\":\"resolved\",\"body\":\"Service recovery is complete, and the cluster has been scaled up. We hopefully don't expect this issue to recur after this. \\n\\nApologies again for all the inconvenience!\",\"created_at\":\"2018-09-30T10:05:40.992-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-09-30T10:05:40.992-07:00\",\"display_at\":\"2018-09-30T10:05:40.992-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"k2sm39cz8n69\",\"incident_id\":\"r4fxdx5t8lls\",\"custom_tweet\":null},{\"status\":\"identified\",\"body\":\"Additional capacity has been added and we've rebooted the service. Service recovery is underway and is expected to complete momentarily.\",\"created_at\":\"2018-09-30T09:55:36.672-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-09-30T09:55:36.672-07:00\",\"display_at\":\"2018-09-30T09:55:36.672-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"3nskh80flbxz\",\"incident_id\":\"r4fxdx5t8lls\",\"custom_tweet\":null},{\"status\":\"investigating\",\"body\":\"We're investigating similar crash as yesterday, and are restarting the service. Additionally, we are adding more capacity to the service, as we think the crash is load-based.\",\"created_at\":\"2018-09-30T09:37:08.063-07:00\",\"wants_twitter_update\":false,\"twitter_updated_at\":null,\"updated_at\":\"2018-09-30T09:37:08.063-07:00\",\"display_at\":\"2018-09-30T09:37:08.063-07:00\",\"affected_components\":null,\"deliver_notifications\":false,\"tweet_id\":null,\"id\":\"44yqn0ctp163\",\"incident_id\":\"r4fxdx5t8lls\",\"custom_tweet\":null}],\"postmortem_body\":null,\"postmortem_body_last_updated_at\":null,\"postmortem_ignored\":false,\"postmortem_published_at\":null,\"postmortem_notified_subscribers\":false,\"postmortem_notified_twitter\":false}]}";
            return JsonConvert.DeserializeObject<StatusPageClasses.Index>(content);
        }
        public static async Task<StatusPageClasses.AllMetrics> GetMetrics(string duration = "day")
       {
            using (HttpClient client = new HttpClient())
           {
                IInputStream stream;
               try
               {
                   stream = await client.GetInputStreamAsync(new Uri(Url + "metrics-display/"+MetricsId+"/"+duration+".json"));
               }
               catch (Exception)
               {
                   return null;
               }
               using (StreamReader reader = new StreamReader(stream.AsStreamForRead()))
               {
                   using (var jsonTextReader = new JsonTextReader(reader))
                   {
                       JsonSerializer serializer = new JsonSerializer();
                       return serializer.Deserialize<StatusPageClasses.AllMetrics>(jsonTextReader);
                   }
               }
           }
       }
    }
}
